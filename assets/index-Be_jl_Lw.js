import{b as h,j as s,h as T}from"./index-BTIbGg6b.js";import{u as V,a as D,F as S,b as k,C as R,o as I,s as A,c as b,A as y}from"./useTimeOutMessage-DL3j9AXL.js";import{B as F}from"./Button-B29EPoIq.js";import{I as B}from"./FormContainer-CD-ONq0O.js";import"./StatusIcon-DJBR6lRy.js";const E=({length:t=6,value:r="",onChange:o,disabled:p=!1,className:m="",inputClass:u,autoFocus:f=!1,placeholder:i,invalid:j=!1})=>{const[O,n]=h.useState(0),c=h.useRef([]);h.useEffect(()=>{c.current=Array(t).fill(null).map((a,e)=>c.current[e]||null)},[t]);const d=(a,e)=>{const l=a.target.value;if(l.length>1)return;const P=r.slice(0,e)+l+r.slice(e+1);o?.(P),l&&e<t-1&&(n(e+1),c.current[e+1]?.focus())},N=(a,e)=>{if(a.key==="Backspace")if(a.preventDefault(),r[e]){const l=r.slice(0,e)+""+r.slice(e+1);o?.(l)}else e>0&&(n(e-1),c.current[e-1]?.focus());else a.key==="ArrowLeft"&&e>0?(a.preventDefault(),n(e-1),c.current[e-1]?.focus()):a.key==="ArrowRight"&&e<t-1&&(a.preventDefault(),n(e+1),c.current[e+1]?.focus())},v=a=>{a.preventDefault();const e=a.clipboardData.getData("text/plain").slice(0,t);e.match(/^[0-9]+$/)&&o?.(e.padEnd(t,""))},w=a=>e=>{c.current[a]=e};return s.jsx("div",{className:`flex gap-2 ${m}`,children:Array(t).fill(null).map((a,e)=>s.jsx(B,{ref:w(e),className:T("text-center text-lg h-[58px] w-[58px]",u),type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:1,value:r[e]||"",disabled:p,autoFocus:f&&e===0,placeholder:i,"aria-label":`Digit ${e+1} of ${t}`,invalid:j,onChange:l=>d(l,e),onKeyDown:l=>N(l,e),onPaste:v,onFocus:()=>n(e)},e))})},g=t=>new Promise(r=>setTimeout(r,t)),x=6,M=I({otp:A().min(x,{message:"Please enter a valid OTP"})}),C=t=>{const[r,o]=h.useState(!1),{className:p,setMessage:m,setOtpVerified:u}=t,{handleSubmit:f,formState:{errors:i},control:j}=V({resolver:D(M)}),O=async n=>{const{otp:c}=n;o(!0);try{await g(1e3),o(!1),u?.("OTP verified!")}catch(d){m?.(typeof d=="string"?d:"Some error occured!"),o(!1)}console.log("otp",c),o(!1)};return s.jsx("div",{className:p,children:s.jsxs(S,{onSubmit:f(O),children:[s.jsx(k,{invalid:!!i.otp,errorMessage:i.otp?.message,children:s.jsx(R,{name:"otp",control:j,render:({field:n})=>s.jsx(E,{placeholder:"",inputClass:"h-[58px]",length:x,...n})})}),s.jsx(F,{block:!0,loading:r,variant:"solid",type:"submit",children:r?"Verifying...":"Verify OTP"})]})})},_=()=>{const[t,r]=b(),[o,p]=b(),[m,u]=b(),f=async()=>{try{await g(500),p("We have sent you One Time Password.")}catch(i){u?.(typeof i=="string"?i:"Some error occured!")}};return s.jsxs("div",{children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h3",{className:"mb-2",children:"OTP Verification"}),s.jsx("p",{className:"font-semibold heading-text",children:"We have sent you One Time Password to your email."})]}),m&&s.jsx(y,{showIcon:!0,className:"mb-4",type:"danger",children:s.jsx("span",{className:"break-all",children:m})}),o&&s.jsx(y,{showIcon:!0,className:"mb-4",type:"info",children:s.jsx("span",{className:"break-all",children:o})}),t&&s.jsx(y,{showIcon:!0,className:"mb-4",type:"success",children:s.jsx("span",{className:"break-all",children:t})}),s.jsx(C,{setMessage:u,setOtpVerified:r}),s.jsxs("div",{className:"mt-4 text-center",children:[s.jsx("span",{className:"font-semibold",children:"Din't receive OTP? "}),s.jsx("button",{className:"heading-text font-bold underline",onClick:f,children:"Resend OTP"})]})]})},H=()=>s.jsx(_,{});export{_ as OtpVerificationBase,H as default};
